use anyhow::Result;
use clap::Parser;

/// Prints your text in a text bubble with KittyCAD as ASCII art
///
///     $ kittycad say
#[derive(Parser, Debug, Clone)]
#[clap(verbatim_doc_comment)]
pub struct CmdSay {
    /// What kitty says
    #[clap(name = "input", required = false, multiple_values = true)]
    pub input: Vec<String>,
}

#[async_trait::async_trait]
impl crate::cmd::Command for CmdSay {
    async fn run(&self, ctx: &mut crate::context::Context) -> Result<()> {
        let kitty_string;
        if self.input.len() > 0 {
            let text = self.input.join(" ");
            let mut border = String::from("--");
            let bar = String::from("|");
            let print_text = format!("{}{}{}", bar, text, bar);
            for _i in 0..text.len() {
                border.push('-');
            }
            kitty_string = "  \\                                                            
   \\                .....                                 
    \\              .::-:...            .....              
     \\            ..:---..:...        .::::...            
      \\          ..------:.::::::::::.:----......         
       \\      .::::------:::::::::::..------:..::::::::-. 
        \\   .::::..........::::::::::::::----:::::::::---. 
         \\  ::::::::::::::::::::::::...........::::::::---. 
          \\ :--:::::::::::::::::::::::::::::::::::::::----. 
            :--::=#@@@%%%###***+++===---::::::::--::-=----. 
            :--::#@@@@@@@@@@@@@@@@@@@@@@@@@#-:::---:=-=---. 
            :--::#@@@@@@@@@@@@@@@@@@@@@@@@@@@:::----++=---. 
            :--::#@@@@%***#@@@@@@@@@*+*@@@@@@:::----=+----. 
            :--::#@@@**%%%#+@@@@@@@@=-=@@@@@@:::----------  
            :---:#@@@@@@@@@@@%%%%@@@=-=@@@@@@:::---------=  
            -----#@@@@@@@**@@#+-+#@@#%%@@@@@@:::--------==  
            -----#@@@@@@@@%+#%#-%@%+*#@@@@@@@::--------===  
            -----*%@@@@@@@@@***+++*%@@@@@@@@@----------===. 
            ------=+***####%%%@@@@@@@@@@@@@@@---------====. 
            ----------::::::::::::--===+++*+:--------=====  
            --==---===---::::::::::::::::-----------=====+  
            -------+**+----------------------------====***  
            ---------------::::::::::------------======#**  
            -----=+++++-----------------=-=--=---======*+=  
            -----=+++++--#@@@%%%%###+---=-=--+---======:.   
            .......::----+####%%%%@@*---++++++---===:.      
                  .*########*:.......:==--------.         
                :*#%%%%%%%%%%+       -%######*#+.         
                =#########%%%+     =#%%%%%%%%%##-         
                -++***#####=.      *############:         
                                   -==++***##+:           
";
            writeln!(ctx.io.out, "{}", border).ok();
            writeln!(ctx.io.out, "{}", print_text).ok();
            writeln!(ctx.io.out, "{}", border).ok();
            writeln!(ctx.io.out, "{}", kitty_string).ok();
        } else {
            kitty_string = "                                                  
                    .....                                 
                   .::-:...            .....              
                  ..:---..:...        .::::...            
                 ..------:.::::::::::.:----......         
              .::::------:::::::::::..------:..::::::::-. 
            .::::..........::::::::::::::----:::::::::---. 
            ::::::::::::::::::::::::...........::::::::---. 
            :--:::::::::::::::::::::::::::::::::::::::----. 
            :--::=#@@@%%%###***+++===---::::::::--::-=----. 
            :--::#@@@@@@@@@@@@@@@@@@@@@@@@@#-:::---:=-=---. 
            :--::#@@@@@@@@@@@@@@@@@@@@@@@@@@@:::----++=---. 
            :--::#@@@@%***#@@@@@@@@@*+*@@@@@@:::----=+----. 
            :--::#@@@**%%%#+@@@@@@@@=-=@@@@@@:::----------  
            :---:#@@@@@@@@@@@%%%%@@@=-=@@@@@@:::---------=  
            -----#@@@@@@@**@@#+-+#@@#%%@@@@@@:::--------==  
            -----#@@@@@@@@%+#%#-%@%+*#@@@@@@@::--------===  
            -----*%@@@@@@@@@***+++*%@@@@@@@@@----------===. 
            ------=+***####%%%@@@@@@@@@@@@@@@---------====. 
            ----------::::::::::::--===+++*+:--------=====  
            --==---===---::::::::::::::::-----------=====+  
            -------+**+----------------------------====***  
            ---------------::::::::::------------======#**  
            -----=+++++-----------------=-=--=---======*+=  
            -----=+++++--#@@@%%%%###+---=-=--+---======:.   
            .......::----+####%%%%@@*---++++++---===:.      
                  .*########*:.......:==--------.         
                :*#%%%%%%%%%%+       -%######*#+.         
                =#########%%%+     =#%%%%%%%%%##-         
                -++***#####=.      *############:         
                                   -==++***##+:           
";
            writeln!(ctx.io.out, "{}", kitty_string).ok();
        }
        Ok(())
    }
}
